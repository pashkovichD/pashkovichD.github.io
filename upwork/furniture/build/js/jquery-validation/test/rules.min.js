module("rules"),test("rules() - internal - input",function(){var e=$("#firstname");$("#testForm1").validate(),deepEqual(e.rules(),{required:!0,minlength:2})}),test("rules(), ignore method:false",function(){var e=$("#firstnamec");$("#testForm1clean").validate({rules:{firstnamec:{required:!1,minlength:2}}}),deepEqual(e.rules(),{minlength:2})}),test("rules() HTML5 required (no value)",function(){var e=$("#testForm11text1");$("#testForm11").validate(),deepEqual(e.rules(),{required:!0})}),test("rules() - internal - select",function(){var e=$("#meal");$("#testForm3").validate(),deepEqual(e.rules(),{required:!0})}),test("rules() - external",function(){var e=$("#text1");$("#form").validate({rules:{action:{date:!0,min:5}}}),deepEqual(e.rules(),{date:!0,min:5})}),test("rules() - external - complete form",function(){expect(1);var e=$.extend({},$.validator.methods),t=$.extend({},$.validator.messages);$.validator.addMethod("verifyTest",function(){return ok(!0,"method executed"),!0}),$("#form").validate({rules:{action:{verifyTest:!0}}}).form(),$.validator.methods=e,$.validator.messages=t}),test("rules() - internal - input",function(){var e=$("#form8input");$("#testForm8").validate(),deepEqual(e.rules(),{required:!0,number:!0,rangelength:[2,8]})}),test("rules(), merge min/max to range, minlength/maxlength to rangelength",function(){jQuery.validator.autoCreateRanges=!0,$("#testForm1clean").validate({rules:{firstnamec:{min:-15,max:0},lastname:{minlength:0,maxlength:10}}}),deepEqual($("#firstnamec").rules(),{range:[-15,0]}),deepEqual($("#lastnamec").rules(),{rangelength:[0,10]}),jQuery.validator.autoCreateRanges=!1}),test("rules(), guarantee that required is at front",function(){$("#testForm1").validate();$("#v2").validate();function e(e){var t=[];return jQuery.each($(e).rules(),function(e){t.push(e)}),t.join(" ")}$("#subformRequired").validate(),equal(e("#firstname"),"required minlength"),equal(e("#v2-i6"),"required minlength maxlength"),equal(e("#co_name"),"required maxlength"),QUnit.reset(),jQuery.validator.autoCreateRanges=!0,$("#v2").validate(),equal(e("#v2-i6"),"required rangelength"),$("#subformRequired").validate({rules:{co_name:"required"}}),$("#co_name").removeClass(),equal(e("#co_name"),"required maxlength"),jQuery.validator.autoCreateRanges=!1}),test("rules(), evaluate dynamic parameters",function(){expect(2),$("#testForm1clean").validate({rules:{firstnamec:{min:function(e){return equal($("#firstnamec")[0],e),12}}}}),deepEqual($("#firstnamec").rules(),{min:12})}),test("rules(), class and attribute combinations",function(){$.validator.addMethod("customMethod1",function(){return!1},""),$.validator.addMethod("customMethod2",function(){return!1},""),$("#v2").validate({rules:{"v2-i7":{required:!0,minlength:2,customMethod:!0}}}),deepEqual($("#v2-i1").rules(),{required:!0}),deepEqual($("#v2-i2").rules(),{required:!0,email:!0}),deepEqual($("#v2-i3").rules(),{url:!0}),deepEqual($("#v2-i4").rules(),{required:!0,minlength:2}),deepEqual($("#v2-i5").rules(),{required:!0,minlength:2,maxlength:5,customMethod1:"123"}),jQuery.validator.autoCreateRanges=!0,deepEqual($("#v2-i5").rules(),{required:!0,customMethod1:"123",rangelength:[2,5]}),deepEqual($("#v2-i6").rules(),{required:!0,customMethod2:!0,rangelength:[2,5]}),jQuery.validator.autoCreateRanges=!1,deepEqual($("#v2-i7").rules(),{required:!0,minlength:2,customMethod:!0}),delete $.validator.methods.customMethod1,delete $.validator.messages.customMethod1,delete $.validator.methods.customMethod2,delete $.validator.messages.customMethod2}),test("rules(), dependency checks",function(){var e=$("#testForm1clean").validate({rules:{firstnamec:{min:{param:5,depends:function(e){return/^a/.test($(e).val())}}},lastname:{max:{param:12},email:{depends:function(){return!0}}}}}),t=$("#firstnamec").rules();equal(e.objectLength(t),0),$("#firstnamec").val("ab"),deepEqual($("#firstnamec").rules(),{min:5}),deepEqual($("#lastnamec").rules(),{max:12,email:!0})}),test("rules(), add and remove",function(){$.validator.addMethod("customMethod1",function(){return!1},""),$("#v2").validate(),$("#v2-i5").removeClass("required").removeAttr("minlength maxlength"),deepEqual($("#v2-i5").rules(),{customMethod1:"123"}),$("#v2-i5").addClass("required").attr({minlength:2,maxlength:5}),deepEqual($("#v2-i5").rules(),{required:!0,minlength:2,maxlength:5,customMethod1:"123"}),$("#v2-i5").addClass("email").attr({min:5}),deepEqual($("#v2-i5").rules(),{required:!0,email:!0,minlength:2,maxlength:5,min:5,customMethod1:"123"}),$("#v2-i5").removeClass("required email").removeAttr("minlength maxlength customMethod1 min"),deepEqual($("#v2-i5").rules(),{}),delete $.validator.methods.customMethod1,delete $.validator.messages.customMethod1}),test("rules(), add and remove static rules",function(){$("#testForm1clean").validate({rules:{firstnamec:"required date"}}),deepEqual($("#firstnamec").rules(),{required:!0,date:!0}),$("#firstnamec").rules("remove","date"),deepEqual($("#firstnamec").rules(),{required:!0}),$("#firstnamec").rules("add","email"),deepEqual($("#firstnamec").rules(),{required:!0,email:!0}),$("#firstnamec").rules("remove","required"),deepEqual($("#firstnamec").rules(),{email:!0}),deepEqual($("#firstnamec").rules("remove"),{email:!0}),deepEqual($("#firstnamec").rules(),{}),$("#firstnamec").rules("add","required email"),deepEqual($("#firstnamec").rules(),{required:!0,email:!0}),deepEqual($("#lastnamec").rules(),{}),$("#lastnamec").rules("add","required"),$("#lastnamec").rules("add",{minlength:2}),deepEqual($("#lastnamec").rules(),{required:!0,minlength:2});var e=$("#lastnamec").rules("remove","required email");deepEqual($("#lastnamec").rules(),{minlength:2}),$("#lastnamec").rules("add",e),deepEqual($("#lastnamec").rules(),{required:!0,minlength:2})}),test("rules(), add messages",function(){$("#firstnamec").attr("title",null);var e=$("#testForm1clean").validate({rules:{firstnamec:"required"}});$("#testForm1clean").valid(),$("#firstnamec").valid(),deepEqual(e.settings.messages.firstname,void 0),$("#firstnamec").rules("add",{messages:{required:"required"}}),$("#firstnamec").valid(),deepEqual(e.errorList[0]&&e.errorList[0].message,"required"),$("#firstnamec").val("test"),$("#firstnamec").valid(),equal(e.errorList.length,0)}),test("rules(), rangelength attribute as array",function(){$("#testForm13").validate(),deepEqual($("#cars-select").rules(),{required:!0,rangelength:[2,3]})}),test("rules(), normalizer",function(){var e,t=$("#usernamec"),r=$("#urlc"),a=$("#lastnamec");t.val("\t\t \r"),r.val(""),e=$("#testForm1clean").validate({rules:{username:{required:!0,normalizer:function(e){return equal(this,t[0],"`this` in the normalizer should be the username element."),$.trim(e)}},urlc:{required:!0,url:!0,normalizer:function(e){equal(this,r[0],"`this` in the normalizer should be the urlc element.");return e=e&&"http://"!==e.substr(0,7)&&"https://"!==e.substr(0,8)&&"ftp://"!==e.substr(0,6)?"https://"+e:e}},lastname:{required:!0,normalizer:function(e){return equal(this,a[0],"`this` in the normalizer should be the lastname element."),null}}}}),t.valid(),equal(e.invalidElements()[0],t[0],"The username should be invalid"),r.valid(),equal(e.invalidElements()[0],r[0],"The url should be invalid"),equal(e.numberOfInvalids(),2,"There is two invalid elements"),t.val("something"),r.val("google.com"),t.trigger("keyup"),r.trigger("keyup"),equal(e.numberOfInvalids(),0,"All elements are valid"),equal(e.size(),0,"All elements are valid"),throws(function(){e.check(a[0])},function(e){return"TypeError"===e.name&&"The normalizer should return a string value."===e.message},"This should throw a TypeError exception.")}),test("rules() - on unexpected input",function(){var e=$("#firstname .mynonexistantclass"),t=$("div#foo"),e=e.rules("add","whatever");deepEqual(e,void 0,"can work on an empty set without a js error"),e=t.rules("add","whatever"),deepEqual(e,void 0,"can work on a non-form element")});