window.sessionStorage&&sessionStorage.clear(),jQuery.validator.defaults.debug=!0,$.mockjaxSettings.log=$.noop,$.mockjax({url:"form.php?user=Peter&password=foobar",responseText:"Hi Peter, welcome back.",responseStatus:200,responseTime:1}),$.mockjax({url:"users.php",data:{username:/Peter2?|asdf/},responseText:"false",responseStatus:200,responseTime:1}),$.mockjax({url:"users2.php",data:{username:"asdf"},responseText:'"asdf is already taken, please try something else"',responseStatus:200,responseTime:1}),$.mockjax({url:"echo.php",response:function(e){this.responseText=JSON.stringify(e.data)},responseTime:100}),$.mockjax({url:"response.php",response:function(e){var t=e.data.responseText;this.responseText=t?"function"==typeof t?t():t:"",this.responseStatus=e.data.responseStatus||200,this.responseTime=e.data.responseTime||100}}),$.mockjax({url:"issue1508.php",response:function(e){/abc/i.test(e.data.val2)?this.responseText="false":this.responseText="true"},responseStatus:200,responseTime:1}),$.mockjax({url:"workemail.php",response:function(e){this.responseStatus="somevalue"===e.data.special?200:400,200===this.responseStatus&&(this.responseText=JSON.stringify("john.doe@company.com"===e.data.email))}}),QUnit.assert.hasError=function(e,t,a){e=$(e).closest("form").validate().errorsFor(e[0]),e=1===e.length&&e.is(":visible")?e.text():"";QUnit.push(e,e,t,a)},QUnit.assert.noErrorFor=function(e,t){e=$(e).closest("form").validate().errorsFor(e[0]),e=0===e.length||e.is(":hidden")&&""===e.text();QUnit.push(e,e,!0,t)},module("validator"),test("Constructor",function(){var e=$("#testForm1").validate(),t=$("#testForm1").validate();equal(e,t,"Calling validate() multiple times must return the same validator instance"),equal(e.elements().length,3,"validator elements")}),test("validate() without elements, with non-form elements",0,function(){$("#doesntexist").validate()}),test("valid() plugin method",function(){var e=$("#userForm"),t=$("#username");e.validate(),ok(!e.valid(),"Form isn't valid yet"),ok(!t.valid(),"Input isn't valid either"),t.val("Hello world"),ok(e.valid(),"Form is now valid"),ok(t.valid(),"Input is valid, too")}),test("valid() plugin method, multiple inputs",function(){var e=$("#testForm1"),t=e.validate(),e=e.find("input");ok(!e.valid(),"all invalid"),e.not(":first").val("ok"),equal(t.numberOfInvalids(),2),strictEqual(e.valid(),!1,"just one invalid"),e.val("ok"),strictEqual(e.valid(),!0,"all valid")}),test("valid() plugin method, special handling for checkable groups",function(){var e=$("#checkable2");ok(!e.valid(),"must be invalid, not checked yet"),e.attr("checked",!0),ok(e.valid(),"valid, is now checked"),e.attr("checked",!1),ok(!e.valid(),"invalid again"),$("#checkable3").attr("checked",!0),ok(e.valid(),"valid, third box is checked")}),test("valid() ???",function(){expect(4);var e=[{name:"meal",message:"foo",element:$("#meal")[0]}],t=$("#testForm3").validate();ok(t.valid(),"No errors, must be valid"),t.errorList=e,ok(!t.valid(),"One error, must be invalid"),QUnit.reset(),t=$("#testForm3").validate({submitHandler:function(){ok(!1,"Submit handler was called")}}),ok(t.valid(),"No errors, must be valid and returning true, even with the submit handler"),t.errorList=e,ok(!t.valid(),"One error, must be invalid, no call to submit handler")}),test("valid(), ignores ignored elements",function(){$("#testForm1clean").validate({ignore:"#firstnamec",rules:{firstnamec:"required"}}),ok($("#firstnamec").valid())}),test("addMethod",function(){expect(3),$.validator.addMethod("hi",function(e){return"hi"===e},"hi me too");var e=$.validator.methods.hi,t=$("#text1")[0];ok(!e(t.value,t),"Invalid"),t.value="hi",ok(e(t.value,t),"Invalid"),ok("hi me too"===jQuery.validator.messages.hi,"Check custom message")}),test("addMethod2",function(){expect(4),$.validator.addMethod("complicatedPassword",function(e,t){return this.optional(t)||/\D/.test(e)&&/\d/.test(e)},"Your password must contain at least one number and one letter");var e=jQuery("#form").validate({rules:{action:{complicatedPassword:!0}}}),t=$("#text1")[0];t.value="",strictEqual(e.element(t),!0,"Rule is optional, valid"),equal(e.size(),0),t.value="ko",ok(!e.element(t),"Invalid, doesn't contain one of the required characters"),t.value="ko1",ok(e.element(t))}),test("form(): simple",function(){expect(2);var e=$("#testForm1")[0],e=$(e).validate();ok(!e.form(),"Invalid form"),$("#firstname").val("hi"),$("#lastname").val("hi"),ok(e.form(),"Valid form")}),test("form(): checkboxes: min/required",function(){expect(3);var e=$("#testForm6")[0],e=$(e).validate();ok(!e.form(),"Invalid form"),$("#form6check1").attr("checked",!0),ok(!e.form(),"Invalid form"),$("#form6check2").attr("checked",!0),ok(e.form(),"Valid form")}),test("form(): radio buttons: required",function(){expect(6);var e=$("#testForm10")[0],e=$(e).validate({rules:{testForm10Radio:"required"}});ok(!e.form(),"Invalid Form"),equal($("#testForm10Radio1").attr("class"),"error"),equal($("#testForm10Radio2").attr("class"),"error"),$("#testForm10Radio2").attr("checked",!0),ok(e.form(),"Valid form"),equal($("#testForm10Radio1").attr("class"),"valid"),equal($("#testForm10Radio2").attr("class"),"valid")}),test("form(): selects: min/required",function(){expect(3);var e=$("#testForm7")[0],e=$(e).validate();ok(!e.form(),"Invalid form"),$("#optionxa").attr("selected",!0),ok(!e.form(),"Invalid form"),$("#optionxb").attr("selected",!0),ok(e.form(),"Valid form")}),test("form(): with equalTo",function(){expect(2);var e=$("#testForm5")[0],e=$(e).validate();ok(!e.form(),"Invalid form"),$("#x1, #x2").val("hi"),ok(e.form(),"Valid form")}),test("form(): with equalTo and onfocusout=false",function(){expect(4);var e=$("#testForm5")[0],e=$(e).validate({onfocusout:!1,showErrors:function(){ok(!0,"showErrors should only be called twice"),this.defaultShowErrors()}});$("#x1, #x2").val("hi"),ok(e.form(),"Valid form"),$("#x2").val("not equal").blur(),ok(!e.form(),"Invalid form")}),test("check(): simple",function(){expect(3);var e=$("#firstname")[0],t=$("#testForm1").validate();ok(0===t.size(),"No errors yet"),t.check(e),ok(1===t.size(),"error exists"),t.errorList=[],$("#firstname").val("hi"),t.check(e),ok(0===t.size(),"No more errors")}),test("hide(): input",function(){expect(3);var e,t=$("#errorFirstname"),a=$("#firstname")[0];a.value="bla",e=$("#testForm1").validate(),t.show(),ok(t.is(":visible"),"Error label visible before validation"),ok(e.element(a)),ok(t.is(":hidden"),"Error label not visible after validation")}),test("hide(): radio",function(){expect(2);var e,t=$("#agreeLabel"),a=$("#agb")[0];a.checked=!0,e=$("#testForm2").validate({errorClass:"xerror"}),t.show(),ok(t.is(":visible"),"Error label visible after validation"),e.element(a),ok(t.is(":hidden"),"Error label not visible after hiding it")}),test("hide(): errorWrapper",function(){expect(2);var e=$("#errorWrapper"),t=$("#meal")[0];t.selectedIndex=1,e.show(),ok(e.is(":visible"),"Error label visible after validation"),$("#testForm3").validate({wrapper:"li",errorLabelContainer:$("#errorContainer")}).element(t),ok(e.is(":hidden"),"Error label not visible after hiding it")}),test("hide(): container",function(){expect(4);var e=$("#errorContainer"),t=$("#testForm3").validate({errorWrapper:"li",errorContainer:$("#errorContainer")});t.form(),ok(e.is(":visible"),"Error label visible after validation"),$("#meal")[0].selectedIndex=1,t.form(),ok(e.is(":hidden"),"Error label not visible after hiding it"),$("#meal")[0].selectedIndex=-1,t.element("#meal"),ok(e.is(":visible"),"Error label visible after validation"),$("#meal")[0].selectedIndex=1,t.element("#meal"),ok(e.is(":hidden"),"Error label not visible after hiding it")}),test("submitHandler keeps submitting button",function(){var t,e;$("#userForm").validate({debug:!0,submitHandler:function(e){e=$(e).find("input:hidden")[0];deepEqual(e.value,t.value),deepEqual(e.name,t.name)}}),$("#username").val("bla"),t=$("#userForm :submit")[0],(e=$.Event("click")).preventDefault(),$.event.trigger(e,null,t),$("#userForm").submit()}),asyncTest("validation triggered on radio/checkbox when using keyboard",function(){expect(1);var e,t,a,r=0;for($("#form").validate({onfocusin:function(){r++},onfocusout:function(){r++},onkeyup:function(){r++}}),a=[$.Event("focusin"),$.Event("focusout"),$.Event("keyup")],e=$("#form :radio:first"),t=0;t<a.length;t++)e.trigger(a[t]);for(e=$("#form :checkbox:first"),t=0;t<a.length;t++)e.trigger(a[t]);setTimeout(function(){equal(r,6),start()})}),asyncTest("validation triggered on radio/checkbox when using mouseclick",function(){expect(1);var e,t,a,r=0;for($("#form").validate({onclick:function(){r++}}),a=[$.Event("click")],e=$("#form :radio:first"),t=0;t<a.length;t++)e.trigger(a[t]);for(e=$("#form :checkbox:first"),t=0;t<a.length;t++)e.trigger(a[t]);setTimeout(function(){equal(r,2),start()})}),test("showErrors()",function(){expect(4);var e=$("#errorFirstname").hide(),t=$("#testForm1").validate();ok(e.is(":hidden")),equal($("#lastname").next(".error:not(input)").length,0),t.showErrors({firstname:"required",lastname:"bla"}),equal(e.is(":visible"),!0),equal($("#lastname").next(".error:not(input)").is(":visible"),!0)}),test("showErrors(), allow empty string and null as default message",function(){$("#userForm").validate({rules:{username:{required:!0,minlength:3}},messages:{username:{required:"",minlength:"too short"}}}),ok(!$("#username").valid()),equal($("#username").next(".error:not(input)").text(),""),$("#username").val("ab"),ok(!$("#username").valid()),equal($("#username").next(".error:not(input)").text(),"too short"),$("#username").val("abc"),ok($("#username").valid()),ok($("#username").next(".error:not(input)").is(":hidden"))}),test("showErrors() - external messages",function(){expect(4);var e,t=$.extend({},$.validator.methods),a=$.extend({},$.validator.messages);$.validator.addMethod("foo",function(){return!1}),$.validator.addMethod("bar",function(){return!1}),equal($("#testForm4 #f1").next(".error:not(input)").length,0),equal($("#testForm4 #f2").next(".error:not(input)").length,0),e=$("#testForm4")[0],$(e).validate({messages:{f1:"Please!",f2:"Wohoo!"}}).form(),equal($("#testForm4 #f1").next(".error:not(input)").text(),"Please!"),equal($("#testForm4 #f2").next(".error:not(input)").text(),"Wohoo!"),$.validator.methods=t,$.validator.messages=a}),test("showErrors() - custom handler",function(){expect(5);var a=$("#testForm1").validate({showErrors:function(e,t){equal(a,this),equal(a.errorList,t),equal(a.errorMap,e),equal(e.firstname,"buga"),equal(e.lastname,"buga")}});a.form()}),test("option: (un)highlight, default",function(){$("#testForm1").validate();var e=$("#firstname");ok(!e.hasClass("error")),ok(!e.hasClass("valid")),e.valid(),ok(e.hasClass("error")),ok(!e.hasClass("valid")),e.val("hithere").valid(),ok(!e.hasClass("error")),ok(e.hasClass("valid"))}),test("option: (un)highlight, nothing",function(){expect(3),$("#testForm1").validate({highlight:!1,unhighlight:!1});var e=$("#firstname");ok(!e.hasClass("error")),e.valid(),ok(!e.hasClass("error")),e.valid(),ok(!e.hasClass("error"))}),test("option: (un)highlight, custom",function(){expect(5),$("#testForm1clean").validate({highlight:function(e,t){equal(t,"invalid"),$(e).hide()},unhighlight:function(e,t){equal(t,"invalid"),$(e).show()},ignore:"",errorClass:"invalid",rules:{firstnamec:"required"}});var e=$("#firstnamec");ok(e.is(":visible")),e.valid(),ok(!e.is(":visible")),e.val("hithere").valid(),ok(e.is(":visible"))}),test("option: (un)highlight, custom2",function(){var e,t;expect(6),$("#testForm1").validate({highlight:function(e,t){$(e).addClass(t),$(e).next(".error:not(input)").addClass(t)},unhighlight:function(e,t){$(e).removeClass(t),$(e).next(".error:not(input)").removeClass(t)},errorClass:"invalid"}),e=$("#firstname"),t=$("#errorFirstname"),ok(!e.is(".invalid")),ok(!t.is(".invalid")),e.valid(),ok(e.is(".invalid")),ok(t.is(".invalid")),e.val("hithere").valid(),ok(!e.is(".invalid")),ok(!t.is(".invalid"))}),QUnit.test("option: errorPlacement",function(e){e.expect(1);var t=$("#testForm1").validate({errorPlacement:function(){e.strictEqual(this,t,"'this' inside errorPlacement should be the plugin instance")}});t.form()}),test("option: focusCleanup default false",function(){var e=$("#userForm");e.validate(),e.valid(),ok(e.find("#username").next(".error:not(input)").is(":visible")),$("#username").focus(),ok(e.find("#username").next(".error:not(input)").is(":visible"))}),test("option: focusCleanup true",function(){var e=$("#userForm");e.validate({focusCleanup:!0}),e.valid(),ok(e.find("#username").next(".error:not(input)").is(":visible")),$("#username").focus().trigger("focusin"),ok(!e.find("#username").next(".error:not(input)").is(":visible"))}),test("option: focusCleanup with wrapper",function(){var e=$("#userForm");e.validate({focusCleanup:!0,wrapper:"span"}),e.valid(),ok(e.is(":has(span:visible:has(.error#username-error))")),$("#username").focus().trigger("focusin"),ok(!e.is(":has(span:visible:has(.error#username-error))"))}),test("option: errorClass with multiple classes",function(){var e=$("#userForm");e.validate({focusCleanup:!0,wrapper:"span",errorClass:"error error1 error2"}),e.valid(),ok(e.is(":has(span:visible:has(.error#username-error))")),ok(e.is(":has(span:visible:has(.error1#username-error))")),ok(e.is(":has(span:visible:has(.error2#username-error))")),$("#username").focus().trigger("focusin"),ok(!e.is(":has(span:visible:has(.error#username-error))")),ok(!e.is(":has(span:visible:has(.error1#username-error))")),ok(!e.is(":has(span:visible:has(.error2#username-error))"))}),test("defaultMessage(), empty title is ignored",function(){var e=$("#userForm").validate();equal(e.defaultMessage($("#username")[0],{method:"required",parameters:!0}),"This field is required."),equal(e.defaultMessage($("#username")[0],"required"),"This field is required.")}),QUnit.test("previousValue()",function(e){e.expect(2);var t=$("#username"),a=$("#userForm").validate();e.deepEqual(a.previousValue(t[0]),{old:null,valid:!0,message:"Please fix this field."},"should be the same"),t.removeData("previousValue"),e.deepEqual(a.previousValue(t[0],"required"),{old:null,valid:!0,message:"This field is required."},"should be the same")}),test("#741: move message processing from formatAndAdd to defaultMessage",function(){var e=$("#testForm22").validate();equal(e.defaultMessage($("#tF22Input")[0],{method:"minlength",parameters:5}),"You should enter at least 5 characters.","defaultMessage() now format the messages"),$("#tF22Input").val("abc"),e.form(),equal(e.errorList[0].message,"You should enter at least 5 characters.")}),test("formatAndAdd",function(){expect(4);var e=$("#form").validate(),t={form:$("#form")[0],name:"bar"};e.formatAndAdd(t,{method:"maxlength",parameters:2}),equal(e.errorList[0].message,"Please enter no more than 2 characters."),equal(e.errorList[0].element.name,"bar"),e.formatAndAdd(t,{method:"range",parameters:[2,4]}),equal(e.errorList[1].message,"Please enter a value between 2 and 4."),e.formatAndAdd(t,{method:"range",parameters:[0,4]}),equal(e.errorList[2].message,"Please enter a value between 0 and 4.")}),test("formatAndAdd2",function(){expect(3);var a=$("#form").validate(),e={form:$("#form")[0],name:"bar"};jQuery.validator.messages.test1=function(e,t){return equal(this,a),equal(e,0),"element "+t.name+" is not valid"},a.formatAndAdd(e,{method:"test1",parameters:0}),equal(a.errorList[0].message,"element bar is not valid")}),test("formatAndAdd, auto detect substitution string",function(){var e=$("#testForm1clean").validate({rules:{firstnamec:{required:!0,rangelength:[5,10]}},messages:{firstnamec:{rangelength:"at least ${0}, up to {1}"}}});$("#firstnamec").val("abc"),e.form(),equal(e.errorList[0].message,"at least 5, up to 10")}),asyncTest("option invalidHandler",function(){expect(1),$("#testForm1clean").validate({invalidHandler:function(){ok(!0,"invalid-form event triggered called"),start()}}),$("#usernamec").val("asdf").rules("add",{required:!0,minlength:5}),$("#testForm1clean").submit()}),test("findByName()",function(){deepEqual(new $.validator({},document.getElementById("form")).findByName(document.getElementById("radio1").name).get(),$("#form").find("[name=radio1]").get())}),test("focusInvalid()",function(){var e=$("#testForm1 input").focus(function(){equal(this,e[0],"focused first element")}),t=$("#testForm1").validate();t.form(),t.focusInvalid()}),test("focusInvalid() after validate a custom set of inputs",function(){var e=$("#testForm1"),t=e.validate(),a=$("#firstname, #lastname, #something");$("#firstname").val("ok"),ok(!a.valid(),"just one invalid"),t.focusInvalid(),equal(e[0].ownerDocument.activeElement,$("#lastname")[0],"focused first element")}),test("findLastActive()",function(){expect(3);var e,t=$("#testForm1").validate();ok(!t.findLastActive()),t.form(),t.focusInvalid(),equal(t.findLastActive(),$("#firstname")[0]),e=$("#lastname").trigger("focus").trigger("focusin")[0],equal(t.lastActive,e)}),test("elementValue() finds radios/checkboxes only within the current form",function(){expect(1);var e=$("#userForm").validate(),t=$("#radio2")[0];ok(!e.elementValue(t))}),test("elementValue() returns the file input's name without the prefix 'C:\\fakepath\\' ",function(){var e=$("#userForm").validate(),t={name:"fakeFile",type:"file",files:{},nodeName:"INPUT",value:"C:\\fakepath\\somefile.txt",form:$("#userForm")[0],hasAttribute:function(){return!1},getAttribute:function(e){if("type"===e)return"file"},setAttribute:function(){}};e.defaultShowErrors=function(){},e.validationTargetFor=function(){return t},equal(e.elementValue(t),"somefile.txt"),$(t).rules("add",{minlength:10}),ok(e.element(t),"The fake file input is valid (length = 12, minlength = 10)"),t.value="C:\\fakepath\\file.txt",ok(!e.element(t),"The fake file input is invalid (length = 8, minlength = 10)"),$(t).rules("remove"),$(t).rules("add",{maxlength:10}),ok(e.element(t),"The fake file input is valid (length = 8, maxlength = 10)"),t.value="C:\\fakepath\\fakefile.txt",ok(!e.element(t),"The fake file input is invalid (length = 12, maxlength = 10)")}),test("",function(){var e=$("#userForm").validate(),t={name:"fakeNumber",type:"number",nodeName:"INPUT",value:"",form:$("#userForm")[0],validity:{badInput:!1},hasAttribute:function(){return!1},getAttribute:function(e){return this[e]},setAttribute:function(){}};e.defaultShowErrors=function(){},e.validationTargetFor=function(){return t},$(t).rules("add",{required:!0}),deepEqual($(t).rules(),{required:!0,number:!0}),ok(!e.element(t),"The fake number input is invalid"),equal(e.errorList[0].message,$.validator.messages.required,"The error message should be the one of required rule."),t.value="Not A Number",t.validity.badInput=!0,ok(!e.element(t),"The fake number input is invalid"),equal(e.errorList[0].message,$.validator.messages.number,"The error message should be the one of number rule."),t.value="2015",t.validity.badInput=!1,ok(e.element(t),"The fake number input is valid")}),test("validating multiple checkboxes with 'required'",function(){expect(3);var e,t=$("#form input[name=check3]").prop("checked",!1);equal(t.length,5),(e=$("#form").validate({rules:{check3:"required"}})).form(),equal(e.size(),1),t.filter(":last").prop("checked",!0),e.form(),equal(e.size(),0)}),test("dynamic form",function(){var a,e=0;function t(){$("<input data-rule-required='true' name='list"+e+++"' />").appendTo("#testForm2")}function r(e,t){equal(a.size(),e,t)}(a=$("#testForm2").validate()).form(),r(1),t(),a.form(),r(2),t(),a.form(),r(3),$("#testForm2 input[name=list1]").remove(),a.form(),r(2),t(),a.form(),r(3),$("#testForm2 input[name^=list]").remove(),a.form(),r(1),$("#agb").attr("disabled",!0),a.form(),r(0),$("#agb").attr("disabled",!1),a.form(),r(1)}),test("idOrName()",function(){expect(4);var e=$("#testForm1").validate();equal(e.idOrName($("#form8input")[0]),"form8input"),equal(e.idOrName($("#form6check1")[0]),"check"),equal(e.idOrName($("#agb")[0]),"agree"),equal(e.idOrName($("#form :button")[0]),"button")}),test("resetForm()",function(){function e(e,t){equal(a.size(),e,t)}var a=$("#testForm1").validate();a.form(),e(2),ok($("#firstname").hasClass("error")),ok($("#something").hasClass("valid")),$("#firstname").val("hiy"),a.resetForm(),e(0),ok(!$("#firstname").hasClass("error")),ok(!$("#something").hasClass("valid")),equal($("#firstname").val(),"","form plugin is included, therefor resetForm must also reset inputs, not only errors")}),test("resetForm() clean styles when custom highlight function is used",function(){var e=$("#testForm1clean"),t=$("#firstnamec");e.validate({highlight:function(e){$(e).hide()},unhighlight:function(e){$(e).show()},ignore:"",errorClass:"invalid",rules:{firstnamec:"required"}}),t.valid(),ok(!t.is(":visible")),e.validate().resetForm(),ok(t.is(":visible"))}),test("message from title",function(){var e=$("#withTitle").validate();e.checkForm(),equal(e.errorList[0].message,"fromtitle","title not used")}),test("ignoreTitle",function(){var e=$("#withTitle").validate({ignoreTitle:!0});e.checkForm(),equal(e.errorList[0].message,$.validator.messages.required,"title used when it should have been ignored")}),asyncTest("ajaxSubmit",function(){expect(1),$("#user").val("Peter"),$("#password").val("foobar"),jQuery("#signupForm").validate({submitHandler:function(e){jQuery(e).ajaxSubmit({success:function(e){equal(e,"Hi Peter, welcome back."),start()}})}}),jQuery("#signupForm").triggerHandler("submit")}),test("validating groups settings parameter",function(){var e=$("<form>").validate({groups:{arrayGroup:["input one","input-two","input three"],stringGroup:"input-four input-five input-six"}});equal(e.groups["input one"],"arrayGroup"),equal(e.groups["input-two"],"arrayGroup"),equal(e.groups["input three"],"arrayGroup"),equal(e.groups["input-four"],"stringGroup"),equal(e.groups["input-five"],"stringGroup"),equal(e.groups["input-six"],"stringGroup")}),QUnit.test("validating group of elements",function(e){var t=$("#testForm26"),a=t.find("[name='day']"),r=t.find("[name='month']"),i=t.find("[name='year']"),n=$.Event("keyup",{keyCode:9}),t=t.validate({groups:{mydate:"day month year"}});t.form(),e.equal(t.invalidElements().length,3,"All 3 elements are invalid"),a.blur(),r.trigger(n),r.focus(),r.val(2),r.trigger("click"),t=t.invalidElements(),e.equal(t.length,2,"Only 2 elements are invalid"),e.deepEqual(t[0],a[0],"The day element is invalid"),e.deepEqual(t[1],i[0],"The year element is invalid")}),test("bypassing validation on form submission",function(){var e=$("#bypassValidation"),t=$("form#bypassValidation :input[id=normalSubmit]"),a=$("form#bypassValidation :input[id=bypassSubmitWithCancel]"),r=$("form#bypassValidation :input[id=bypassSubmitWithNoValidate1]"),i=$("form#bypassValidation :input[id=bypassSubmitWithNoValidate2]"),e=e.validate({debug:!0});a.click(),equal(e.numberOfInvalids(),0,"Validation was bypassed using CSS 'cancel' class."),e.resetForm(),r.click(),equal(e.numberOfInvalids(),0,"Validation was bypassed using blank 'formnovalidate' attribute."),e.resetForm(),i.click(),equal(e.numberOfInvalids(),0,"Validation was bypassed using 'formnovalidate=\"formnovalidate\"' attribute."),e.resetForm(),t.click(),equal(e.numberOfInvalids(),1,"Validation failed correctly")}),test("works on contenteditable fields",function(e){$("#contenteditableForm").valid(),e.hasError($("#contenteditableNumberInvalid"),"Please enter a valid number."),e.hasError($("#contenteditableRequiredInvalid"),"This field is required."),e.hasError($("#contenteditableInput"),"Please enter a valid number."),e.noErrorFor($("#contenteditableNumberValid")),e.noErrorFor($("#contenteditableRequiredValid"))}),test("works on contenteditable fields on input event",function(e){$("#contenteditableForm").validate(),$("#contenteditableNumberInvalid").focus(),$("#contenteditableRequiredInvalid").focus(),$("#contenteditableInput").keyup(),$("#contenteditableNumberValid").focus(),$("#contenteditableRequiredValid").keyup(),e.hasError($("#contenteditableNumberInvalid"),"Please enter a valid number."),e.noErrorFor($("#contenteditableNumberValid")),e.noErrorFor($("#contenteditableRequiredValid"))}),module("misc"),test("success option",function(){expect(7),equal($("#firstname").val(),"");var e=$("#testForm1").validate({success:"valid"}),t=$("#testForm1 .error:not(input)");ok(t.is(".error")),ok(!t.is(".valid")),e.form(),ok(t.is(".error")),ok(!t.is(".valid")),$("#firstname").val("hi"),e.form(),ok(t.is(".error")),ok(t.is(".valid"))}),test("success option2",function(){expect(5),equal($("#firstname").val(),"");var e=$("#testForm1").validate({success:"valid"}),t=$("#testForm1 .error:not(input)");ok(t.is(".error")),ok(!t.is(".valid")),$("#firstname").val("hi"),e.form(),ok(t.is(".error")),ok(t.is(".valid"))}),test("success option3",function(){expect(5),equal($("#firstname").val(),""),$("#errorFirstname").remove();var e=$("#testForm1").validate({success:"valid"});equal($("#testForm1 .error:not(input)").length,0),$("#firstname").val("hi"),e.form(),e=$("#testForm1 .error:not(input)"),equal(e.length,3),ok(e.eq(0).is(".valid")),ok(!e.eq(1).is(".valid"))}),test("successlist",function(){var e=$("#form").validate({success:"xyz"});e.form(),equal(e.successList.length,0)}),test("success isn't called for optional elements with no other rules",function(){expect(4),equal($("#firstname").removeAttr("data-rule-required").removeAttr("data-rule-minlength").val(),""),$("#something").remove(),$("#lastname").remove(),$("#errorFirstname").remove();var e=$("#testForm1").validate({success:function(){ok(!1,"don't call success for optional elements!")},rules:{firstname:{required:!1}}});equal($("#testForm1 .error:not(input)").length,0),e.form(),equal($("#testForm1 .error:not(input)").length,0),$("#firstname").valid(),equal($("#testForm1 .error:not(input)").length,0)}),test("success is called for optional elements with other rules",function(){expect(1),$.validator.addMethod("custom1",function(){return!0},""),$("#testForm1clean").validate({success:function(){ok(!0,"success called correctly!")},rules:{firstnamec:{required:!1,custom1:!0}}}),$("#firstnamec").valid(),delete $.validator.methods.custom1}),test("success callback with element",function(){expect(1);var e=$("#userForm").validate({success:function(e,t){equal(t,$("#username").get(0))}});$("#username").val("hi"),e.form()}),test("all rules are evaluated even if one returns a dependency-mistmatch",function(){expect(6),equal($("#firstname").removeAttr("data-rule-required").removeAttr("data-rule-minlength").val(),""),$("#lastname").remove(),$("#errorFirstname").remove(),$.validator.addMethod("custom1",function(){return ok(!0,"custom method must be evaluated"),!0},"");var e=$("#testForm1").validate({rules:{firstname:{email:!0,custom1:!0}}});equal($("#testForm1 .error:not(input)").length,0),e.form(),equal($("#testForm1 .error:not(input)").length,0),$("#firstname").valid(),equal($("#testForm1 .error:not(input)").length,0),delete $.validator.methods.custom1,delete $.validator.messages.custom1}),test("messages",function(){var e=jQuery.validator.messages;equal(e.maxlength(0),"Please enter no more than 0 characters."),equal(e.minlength(1),"Please enter at least 1 characters."),equal(e.rangelength([1,2]),"Please enter a value between 1 and 2 characters long."),equal(e.max(1),"Please enter a value less than or equal to 1."),equal(e.min(0),"Please enter a value greater than or equal to 0."),equal(e.range([1,2]),"Please enter a value between 1 and 2."),equal(e.step(2),"Please enter a multiple of 2.")}),test("jQuery.validator.format",function(){equal(jQuery.validator.format("Please enter a value between {0} and {1}.",0,1),"Please enter a value between 0 and 1."),equal(jQuery.validator.format("{0} is too fast! Enter a value smaller then {0} and at least {1}",0,-15),"0 is too fast! Enter a value smaller then 0 and at least -15");var e=jQuery.validator.format("{0} is too fast! Enter a value smaller then {0} and at least {1}");equal(e(0,-15),"0 is too fast! Enter a value smaller then 0 and at least -15"),e=jQuery.validator.format("Please enter a value between {0} and {1}."),equal(e([1,2]),"Please enter a value between 1 and 2."),equal($.validator.format("{0}","$0"),"$0")}),test("option: ignore",function(){var e=$("#testForm1").validate({ignore:"[name=lastname]"});e.form(),equal(e.size(),1)}),test("option: subformRequired",function(){jQuery.validator.addMethod("billingRequired",function(e,t){return $("#bill_to_co").is(":checked")?$(t).parents("#subform").length:!this.optional(t)},"");var e=$("#subformRequired").validate();e.form(),equal(e.size(),1),$("#bill_to_co").attr("checked",!1),e.form(),equal(e.size(),2),delete $.validator.methods.billingRequired,delete $.validator.messages.billingRequired}),module("expressions"),test("expression: :blank",function(){var e=$("#lastname")[0];equal($(e).filter(":blank").length,1),e.value=" ",equal($(e).filter(":blank").length,1),e.value="   ",equal($(e).filter(":blank").length,1),e.value=" a ",equal($(e).filter(":blank").length,0)}),test("expression: :filled",function(){var e=$("#lastname")[0];equal($(e).filter(":filled").length,0),e.value=" ",equal($(e).filter(":filled").length,0),e.value="   ",equal($(e).filter(":filled").length,0),e.value=" a ",equal($(e).filter(":filled").length,1),e=$("#meal")[0],equal($(e).filter(":filled").length,0),$(e).val("1"),equal($(e).filter(":filled").length,1),e=$("#selectf7")[0],equal($(e).filter(":filled").length,0),$(e).val(["1","2"]),equal($(e).filter(":filled").length,1)}),test("expression: :unchecked",function(){var e=$("#check2")[0];equal($(e).filter(":unchecked").length,1),e.checked=!0,equal($(e).filter(":unchecked").length,0),e.checked=!1,equal($(e).filter(":unchecked").length,1)}),module("events"),test("validate on blur",function(){function e(e,t){equal(i.size(),e,t)}function t(e){equal(i.errors().filter(":visible").length,e)}function a(e){e.trigger("blur").trigger("focusout")}$("#errorFirstname").hide();var r=$("#firstname"),i=$("#testForm1").validate();$("#something").val(""),a(r),e(0,"No value yet, required is skipped on blur"),t(0),r.val("h"),a(r),e(1,"Required was ignored, but as something was entered, check other rules, minlength isn't met"),t(1),r.val("hh"),a(r),e(0,"All is fine"),t(0),r.val(""),i.form(),e(3,"Submit checks all rules, both fields invalid"),t(3),a(r),e(1,"Blurring the field results in emptying the error list first, then checking the invalid field: its still invalid, don't remove the error"),t(3),r.val("h"),a(r),e(1,"Entering a single character fulfills required, but not minlength: 2, still invalid"),t(3),r.val("hh"),a(r),e(0,"Both required and minlength are met, no errors left"),t(2)}),test("validate on keyup",function(){function e(e,t){equal(r.size(),e,t)}function t(e){e.trigger("keyup")}var a=$("#firstname"),r=$("#testForm1").validate();t(a),e(0,"No value, no errors"),a.val("a"),t(a),e(0,"Value, but not invalid"),a.val(""),r.form(),e(2,"Both invalid"),t(a),e(1,"Only one field validated, still invalid"),a.val("hh"),t(a),e(0,"Not invalid anymore"),a.val("h"),t(a),e(1,"Field didn't loose focus, so validate again, invalid"),a.val("hh"),t(a),e(0,"Valid")}),test("validate on not keyup, only blur",function(){function e(e,t){equal(a.size(),e,t)}var t=$("#firstname"),a=$("#testForm1").validate({onkeyup:!1});e(0),t.val("a"),t.trigger("keyup"),t.keyup(),e(0),t.trigger("blur").trigger("focusout"),e(1)}),test("validate on keyup and blur",function(){function e(e,t){equal(a.size(),e,t)}var t=$("#firstname"),a=$("#testForm1").validate();e(0),t.val("a"),t.trigger("keyup"),e(0),t.trigger("blur").trigger("focusout"),e(1)}),test("validate email on keyup and blur",function(){function e(e,t){equal(a.size(),e,t)}var t=$("#firstname"),a=$("#testForm1").validate();a.form(),e(2),t.val("a"),t.trigger("keyup"),e(1),t.val("aa"),t.trigger("keyup"),e(0)}),test("don't revalidate the field when pressing special characters",function(){function r(e,t){equal(a.size(),e,t)}var i=$("#firstname"),a=$("#testForm1").validate();$("#firstname").val(""),$("#lastname").val("something"),$("#something").val("something"),a.form(),r(1,"Validate manually"),i.val("aaa"),$.each({Shift:16,Ctrl:17,Alt:18,"Caps lock":20,End:35,Home:36,"Left arrow":37,"Up arrow":38,"Right arrow":39,"Down arrow":40,Insert:45,"Num lock":144,"Alt GR":225},function(e,t){var a;a=i,t=t,t=$.Event("keyup",{keyCode:t}),a.trigger(t),r(1,e+" key")}),i.val("aaaaa"),i.trigger("keyup"),r(0,"Normal keyup")}),test("#1508: Validation fails to trigger when next field is already filled out",function(){$("#box2").val("something");var e=$.Event("keyup",{keyCode:9}),t=$("#box1"),a=$("#box2"),r=$("#testForm23").validate({rules:{box1:{required:!0},box2:{required:!0}}});t.val("something"),t.blur(),a.trigger(e),a.focus(),a.blur(),t.trigger(e),t.focus(),t.val(""),t.trigger("keyup"),equal(r.numberOfInvalids(),1,"There is only one invalid element."),equal(r.invalidElements()[0],t[0],"The box1 element should be invalid")}),test("[Remote rule] #1508: Validation fails to trigger when next field is already filled out",function(e){e.expect(2),$("#val3").val("something");var t,a=$.Event("keyup",{keyCode:9}),r=$("#val2"),i=$("#val3"),n=e.async(),o=$("#testForm24").validate({rules:{val2:{remote:{url:"issue1508.php"}},val3:{required:!0}}});t="abc",r.val("something"),r.blur(),i.trigger(a),i.focus(),setTimeout(function(){i.blur(),r.trigger(a),r.focus(),r.val(t),r.trigger("keyup"),setTimeout(function(){equal(o.numberOfInvalids(),1,"There is only one invalid element"),equal(o.invalidElements()[0],r[0],"The val2 element should be invalid"),n()})})}),test("validate checkbox on click",function(){function e(e,t){equal(r.size(),e,t)}function t(e){e.click(),e.valid()}var a=$("#check2"),r=$("#form").validate({rules:{check2:"required"}});t(a),e(0),t(a),equal(r.form(),!1),e(1),t(a),e(0),t(a),e(1)}),test("validate multiple checkbox on click",function(){function e(e,t){equal(i.size(),e,t)}function t(e){e.click(),e.valid()}var a=$("#check1").attr("checked",!1),r=$("#check1b"),i=$("#form").validate({rules:{check:{required:!0,minlength:2}}});t(a),t(r),e(0),t(r),equal(i.form(),!1),e(1),t(r),e(0),t(r),e(1)}),test("correct checkbox receives the error",function(){var e,t,a=$("#check1").attr("checked",!1);$("#check1b").attr("checked",!1),e=$("#form").find("[type=checkbox]").attr("checked",!1).end().validate({rules:{check:{required:!0,minlength:2}}}),equal(e.form(),!1),(t=a).click(),t.valid(),equal(e.form(),!1),ok(e.errorList[0].element.id===e.currentElements[0].id,"the proper checkbox has the error AND is present in currentElements")}),test("validate radio on click",function(){function e(e,t){equal(i.size(),e,t)}function t(e){e.click(),e.valid()}var a=$("#radio1"),r=$("#radio1a"),i=$("#form").validate({rules:{radio1:"required"}});e(0),equal(i.form(),!1),e(1),t(r),e(0),t(a),e(0)}),test("validate input with no type attribute, defaulting to text",function(){function e(e,t){equal(a.size(),e,t)}var a=$("#testForm12").validate(),t=$("#testForm12text");e(0),t.valid(),e(1),t.val("test"),t.trigger("keyup"),e(0)}),module("ignore hidden"),test("ignore hidden elements",function(){var e=$("#userForm"),t=e.validate({rules:{username:"required"}});e.get(0).reset(),ok(!t.form(),"form should be initially invalid"),$("#userForm [name=username]").hide(),ok(t.form(),"hidden elements should be ignored by default")}),test("ignore hidden elements at start",function(){var e=$("#userForm"),t=e.validate({rules:{username:"required"}});e.get(0).reset(),$("#userForm [name=username]").hide(),ok(t.form(),"hidden elements should be ignored by default"),$("#userForm [name=username]").show(),ok(!t.form(),"form should be invalid when required element is visible")}),module("configuration with attributes "),test("Specify error messages through data attributes",function(){var e=$("#dataMessages"),t=$("#dataMessagesName");e.validate(),e.get(0).reset(),t.valid(),t=$("#dataMessages .error:not(input)"),equal(t.text(),"You must enter a value here","Correct error label")}),test("Updates pre-existing label if has error class",function(){var e=$("#updateLabel"),t=$("#updateLabelInput"),a=$("#targetLabel"),r=e.find(".error:not(input)").length;e.validate(),t.val(""),t.valid(),e=e.find(".error:not(input)").length,equal(a.text(),t.attr("data-msg-required")),equal(e,r)}),test("Min date set by attribute",function(){var e=$("#rangesMinDateInvalid"),t=$("#minDateInvalid");e.validate(),e.get(0).reset(),t.valid(),t=$("#rangesMinDateInvalid .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 2012-12-21.","Correct error label")}),test("Max date set by attribute",function(){var e=$("#ranges"),t=$("#maxDateInvalid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value less than or equal to 2012-12-21.","Correct error label")}),test("Min and Max date set by attributes greater",function(){var e=$("#ranges"),t=$("#rangeDateInvalidGreater");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value less than or equal to 2013-01-21.","Correct error label")}),test("Min and Max date set by attributes less",function(){var e=$("#ranges"),t=$("#rangeDateInvalidLess");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 2012-11-21.","Correct error label")}),test("Min date set by attribute valid",function(){var e=$("#rangeMinDateValid"),t=$("#minDateValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#rangeMinDateValid .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Max date set by attribute valid",function(){var e=$("#ranges"),t=$("#maxDateValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min and Max date set by attributes valid",function(){var e=$("#ranges"),t=$("#rangeDateValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min and Max strings set by attributes greater",function(){var e=$("#ranges"),t=$("#rangeTextInvalidGreater");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value less than or equal to 200.","Correct error label")}),test("Min and Max strings set by attributes less",function(){var e=$("#ranges"),t=$("#rangeTextInvalidLess");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 200.","Correct error label")}),test("Step string set by attribute invalid",function(){var e=$("#ranges"),t=$("#rangeTextInvalidStep");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a multiple of 100.","Correct error label")}),test("Min, Max and Step strings set by attributes valid",function(){var e=$("#ranges"),t=$("#rangeTextValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min, Max and Step set by data-rule valid",function(){var e=$("#ranges"),t=$("#rangeTextDataRuleValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Step attribute on element with unsupported input type",function(){var e=$("#stepOnUnsupportedType"),t=$("#stepOnUnsupportedTypeInput");throws(function(){e.validate(),e.get(0).reset(),t.valid()},function(e){return"Step attribute on input type date is not supported."===e.message},"Must throw an expected error to pass.")}),test("calling blur on ignored element",function(){var e=$("#ignoredElements");e.validate({ignore:".ignore",submitHandler:$.noop,invalidHandler:function(){$("#ss1").blur()}}),e.trigger("submit"),equal(e.valid(),!1,"valid() should return false")}),test("Min and Max type absent set by attributes greater",function(){var e=$("#ranges"),t=$("#rangeAbsentInvalidGreater");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value less than or equal to 200.","Correct error label")}),test("Min and Max type absent set by attributes less",function(){var e=$("#ranges"),t=$("#rangeAbsentInvalidLess");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 200.","Correct error label")}),test("Step type absent set by attribute invalid",function(){var e=$("#ranges"),t=$("#rangeAbsentInvalidStep");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a multiple of 100.","Correct error label")}),test("Min, Max and Step type absent set by attributes valid",function(){var e=$("#ranges"),t=$("#rangeAbsentValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min, Max and Step range set by attributes valid",function(){var e=$("#ranges"),t=$("#rangeRangeValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min and Max number set by attributes valid",function(){var e=$("#ranges"),t=$("#rangeNumberValid");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Min and Max number set by attributes greater",function(){var e=$("#ranges"),t=$("#rangeNumberInvalidGreater");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value less than or equal to 200.","Correct error label")}),test("Min and Max number set by attributes less",function(){var e=$("#ranges"),t=$("#rangeNumberInvalidLess");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 50.","Correct error label")}),test("Rules allowed to have a value of zero invalid",function(){var e=$("#ranges"),t=$("#rangeMinZeroInvalidLess");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"Please enter a value greater than or equal to 0.","Correct error label")}),test("Rules allowed to have a value of zero valid equal",function(){var e=$("#ranges"),t=$("#rangeMinZeroValidEqual");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Rules allowed to have a value of zero valid greater",function(){var e=$("#ranges"),t=$("#rangeMinZeroValidGreater");e.validate(),e.get(0).reset(),t.valid(),t=$("#ranges .error:not(input)"),equal(t.text(),"","Correct error label")}),test("Validation triggered on radio and checkbox via click",function(){expect(2);var e=$("#radiocheckbox");e.validate(),ok(!e.valid(),"Form invalid"),$("#radiocheckbox-0-1").simulate("click"),$("#radiocheckbox-1-1").simulate("click"),ok(0===e.find("input.error").length,"Form valid")}),test("destroy()",function(){expect(6);var e=$("#testForm5"),t=e.validate();strictEqual(e.data("validator"),t),e.valid(),equal($("#x1",e).hasClass("validate-equalTo-blur"),!0,"The blur event should be bound to this element"),equal($("#x2",e).hasClass("validate-equalTo-blur"),!0,"The blur event should be bound to this element"),t.destroy(),strictEqual(e.data("validator"),void 0),equal($("#x1",e).hasClass("validate-equalTo-blur"),!1,"The blur event should be unbound from this element"),equal($("#x2",e).hasClass("validate-equalTo-blur"),!1,"The blur event should be unbound from this element")}),test("#1618: Errorlist containing more errors than it should",function(){var e=$("#testForm24").validate({rules:{val1:{required:!0},val2:{required:!0},val3:{required:!0}}}),t=$("#val1, #val2, #val3");t.valid(),equal(e.errorList.length,2,"There is only two errors"),t.valid(),equal(e.errorList.length,2,"There should be no change in errorList's content")}),asyncTest("addMethod, reusing remote in custom method",function(){expect(7),$.validator.addMethod("workemail",function(e,t,a){return $.validator.methods.remote.call(this,e,t,{url:"workemail.php",data:{email:e,special:a}},"workemail")},"work email custom message");var e=$("#add-method-username"),t=$("#add-method-remote").validate();$(document).ajaxStop(function(){$(document).unbind("ajaxStop"),strictEqual(t.size(),1,"There must be one error"),strictEqual(t.errorList[0].message,"work email custom message","john.doe@gmail.com is not work email"),$(document).ajaxStop(function(){$(document).unbind("ajaxStop"),strictEqual(t.size(),0,"There must be no errors"),ok(t.element(e),"john.doe@company.com is work email ;)"),start()}),e.val("john.doe@company.com"),strictEqual(t.element(e),!0,"new value, new request; dependency-mismatch considered as valid though")}),strictEqual(t.element(e),!1,"invalid element, nothing entered yet"),e.val("john.doe@gmail.com"),strictEqual(t.element(e),!0,"still invalid, because remote validation must block until it returns; dependency-mismatch considered as valid though")});